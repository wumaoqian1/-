# é—®å·è°ƒæŸ¥ç½‘ç«™éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å°†é—®å·è°ƒæŸ¥ç½‘ç«™éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼š
- **å‰ç«¯**ï¼šéƒ¨ç½²åˆ° Vercel
- **åç«¯**ï¼šéƒ¨ç½²åˆ° Railway
- **æ•°æ®åº“**ï¼šä½¿ç”¨ Supabase

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. ç¡®ä¿é¡¹ç›®æ„å»ºæˆåŠŸ
```bash
# æµ‹è¯•å‰ç«¯æ„å»º
npm run build

# æµ‹è¯•åç«¯æ„å»º
npm run server:build
```

### 2. å‡†å¤‡å¿…è¦çš„è´¦å·
- [Vercel](https://vercel.com) è´¦å·ï¼ˆå‰ç«¯éƒ¨ç½²ï¼‰
- [Railway](https://railway.app) è´¦å·ï¼ˆåç«¯éƒ¨ç½²ï¼‰
- [Supabase](https://supabase.com) é¡¹ç›®ï¼ˆæ•°æ®åº“ï¼‰

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²åç«¯åˆ° Railway

1. **åˆ›å»º Railway é¡¹ç›®**
   - ç™»å½• [Railway Dashboard](https://railway.app/dashboard)
   - ç‚¹å‡» "New Project" â†’ "Deploy from GitHub repo"
   - é€‰æ‹©ä½ çš„é¡¹ç›®ä»“åº“

2. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨ Railway é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
   ```bash
   NODE_ENV=production
   PORT=$PORT
   SUPABASE_URL=your_supabase_project_url
   SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
   JWT_SECRET=your_jwt_secret_key
   CORS_ORIGIN=https://your-vercel-frontend.vercel.app
   ```

3. **é…ç½®æ„å»ºè®¾ç½®**
   - Build Command: `npm run server:build`
   - Start Command: `npm run server:start`
   - Root Directory: `/` (é¡¹ç›®æ ¹ç›®å½•)

4. **éƒ¨ç½²å¹¶è·å–åç«¯URL**
   - Railway ä¼šè‡ªåŠ¨éƒ¨ç½²å¹¶æä¾›ä¸€ä¸ª URL
   - è®°å½•è¿™ä¸ª URLï¼Œæ ¼å¼ç±»ä¼¼ï¼š`https://your-app-name.railway.app`

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²å‰ç«¯åˆ° Vercel

1. **åˆ›å»º Vercel é¡¹ç›®**
   - ç™»å½• [Vercel Dashboard](https://vercel.com/dashboard)
   - ç‚¹å‡» "New Project" â†’ "Import Git Repository"
   - é€‰æ‹©ä½ çš„é¡¹ç›®ä»“åº“

2. **é…ç½®æ„å»ºè®¾ç½®**
   - Framework Preset: `Vite`
   - Build Command: `npm run build`
   - Output Directory: `dist`
   - Install Command: `npm install`

3. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
   ```bash
   VITE_API_URL=https://your-railway-backend.railway.app
   VITE_SUPABASE_URL=your_supabase_project_url
   VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
   ```

4. **æ›´æ–° vercel.json é…ç½®**
   ä¿®æ”¹ `vercel.json` ä¸­çš„åç«¯ URLï¼š
   ```json
   {
     "routes": [
       {
         "src": "/api/(.*)",
         "dest": "https://your-actual-railway-url.railway.app/api/$1"
       }
     ]
   }
   ```

### ç¬¬ä¸‰æ­¥ï¼šæ›´æ–° CORS é…ç½®

1. **è·å–å‰ç«¯åŸŸå**
   - Vercel éƒ¨ç½²å®Œæˆåä¼šæä¾›ä¸€ä¸ªåŸŸå
   - æ ¼å¼ç±»ä¼¼ï¼š`https://your-project-name.vercel.app`

2. **æ›´æ–°åç«¯ CORS é…ç½®**
   - åœ¨ Railway é¡¹ç›®ä¸­æ›´æ–° `CORS_ORIGIN` ç¯å¢ƒå˜é‡
   - è®¾ç½®ä¸ºä½ çš„ Vercel å‰ç«¯åŸŸå

## ğŸ”§ é…ç½®è¯¦è§£

### Supabase é…ç½®è·å–

1. ç™»å½• [Supabase Dashboard](https://supabase.com/dashboard)
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. è¿›å…¥ Settings â†’ API
4. è·å–ä»¥ä¸‹ä¿¡æ¯ï¼š
   - `Project URL` â†’ `SUPABASE_URL`
   - `anon public` â†’ `SUPABASE_ANON_KEY`
   - `service_role` â†’ `SUPABASE_SERVICE_ROLE_KEY`

### JWT Secret ç”Ÿæˆ

```bash
# ä½¿ç”¨ OpenSSL ç”Ÿæˆå¼ºå¯†ç 
openssl rand -base64 32

# æˆ–ä½¿ç”¨åœ¨çº¿å·¥å…·ç”Ÿæˆ 32 ä½éšæœºå­—ç¬¦ä¸²
```

## ğŸ“ éƒ¨ç½²åæ£€æŸ¥æ¸…å•

- [ ] åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œï¼ˆè®¿é—®å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼‰
- [ ] å‰ç«¯é¡µé¢æ­£å¸¸åŠ è½½
- [ ] ç”¨æˆ·æ³¨å†Œ/ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] é—®å·åˆ›å»º/ç¼–è¾‘åŠŸèƒ½æ­£å¸¸
- [ ] é—®å·å¡«å†™åŠŸèƒ½æ­£å¸¸
- [ ] æ•°æ®ç»Ÿè®¡åŠŸèƒ½æ­£å¸¸
- [ ] API è¯·æ±‚æ­£å¸¸ï¼ˆæ£€æŸ¥ç½‘ç»œé¢æ¿ï¼‰

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### 1. CORS é”™è¯¯
**ç—‡çŠ¶**ï¼šå‰ç«¯æ— æ³•è®¿é—®åç«¯ API
**è§£å†³**ï¼š
- æ£€æŸ¥ Railway ä¸­çš„ `CORS_ORIGIN` ç¯å¢ƒå˜é‡
- ç¡®ä¿è®¾ç½®ä¸ºæ­£ç¡®çš„å‰ç«¯åŸŸå
- é‡æ–°éƒ¨ç½²åç«¯æœåŠ¡

### 2. ç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆ
**ç—‡çŠ¶**ï¼šé…ç½®ç›¸å…³åŠŸèƒ½å¼‚å¸¸
**è§£å†³**ï¼š
- æ£€æŸ¥ç¯å¢ƒå˜é‡åç§°æ˜¯å¦æ­£ç¡®
- ç¡®ä¿åœ¨æ­£ç¡®çš„å¹³å°è®¾ç½®ç¯å¢ƒå˜é‡
- é‡æ–°éƒ¨ç½²æœåŠ¡ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ

### 3. æ•°æ®åº“è¿æ¥å¤±è´¥
**ç—‡çŠ¶**ï¼šåç«¯æ— æ³•è¿æ¥ Supabase
**è§£å†³**ï¼š
- æ£€æŸ¥ Supabase URL å’Œå¯†é’¥æ˜¯å¦æ­£ç¡®
- ç¡®ä¿ Supabase é¡¹ç›®çŠ¶æ€æ­£å¸¸
- æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®

### 4. æ„å»ºå¤±è´¥
**ç—‡çŠ¶**ï¼šéƒ¨ç½²æ—¶æ„å»ºè¿‡ç¨‹å¤±è´¥
**è§£å†³**ï¼š
- æ£€æŸ¥ package.json ä¸­çš„æ„å»ºè„šæœ¬
- ç¡®ä¿æ‰€æœ‰ä¾èµ–éƒ½å·²æ­£ç¡®å®‰è£…
- æŸ¥çœ‹æ„å»ºæ—¥å¿—å®šä½å…·ä½“é”™è¯¯

## ğŸ”„ æ›´æ–°éƒ¨ç½²

### è‡ªåŠ¨éƒ¨ç½²
- æ¨é€ä»£ç åˆ° main åˆ†æ”¯ä¼šè‡ªåŠ¨è§¦å‘éƒ¨ç½²
- Vercel å’Œ Railway éƒ½æ”¯æŒ Git é›†æˆ

### æ‰‹åŠ¨éƒ¨ç½²
- Vercelï¼šåœ¨é¡¹ç›®é¢æ¿ç‚¹å‡» "Redeploy"
- Railwayï¼šåœ¨é¡¹ç›®é¢æ¿ç‚¹å‡» "Deploy"

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### Vercel
- è®¿é—®é¡¹ç›®é¢æ¿æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
- æŸ¥çœ‹ Functions æ—¥å¿—ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
- ç›‘æ§ç½‘ç«™æ€§èƒ½å’Œè®¿é—®é‡

### Railway
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—å’Œæ€§èƒ½æŒ‡æ ‡
- ç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ
- è®¾ç½®å‘Šè­¦é€šçŸ¥

### Supabase
- ç›‘æ§æ•°æ®åº“æ€§èƒ½
- æŸ¥çœ‹ API ä½¿ç”¨ç»Ÿè®¡
- æ£€æŸ¥å­˜å‚¨ä½¿ç”¨æƒ…å†µ

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¯ç”¨ CDN**ï¼šVercel è‡ªåŠ¨æä¾›å…¨çƒ CDN
2. **å›¾ç‰‡ä¼˜åŒ–**ï¼šä½¿ç”¨ Vercel çš„å›¾ç‰‡ä¼˜åŒ–åŠŸèƒ½
3. **ç¼“å­˜ç­–ç•¥**ï¼šé…ç½®é€‚å½“çš„ç¼“å­˜å¤´
4. **ä»£ç åˆ†å‰²**ï¼šå·²åœ¨ vite.config.ts ä¸­é…ç½®
5. **ç›‘æ§æ€§èƒ½**ï¼šä½¿ç”¨ Vercel Analytics

---

ğŸ‰ **æ­å–œï¼** ä½ çš„é—®å·è°ƒæŸ¥ç½‘ç«™ç°åœ¨å·²ç»æˆåŠŸéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒäº†ï¼

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥å„å¹³å°çš„æ—¥å¿—å’Œæ–‡æ¡£ï¼Œæˆ–å‚è€ƒæœ¬æŒ‡å—çš„æ•…éšœæ’é™¤éƒ¨åˆ†ã€‚